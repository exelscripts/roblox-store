<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>ExelNotifier</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<style>
body{
  margin:0;
  min-height:100vh;
  display:flex;
  align-items:center;
  justify-content:center;
  font-family:system-ui,sans-serif;
  background:linear-gradient(135deg,#020617,#020617 40%,#0f172a);
  color:#e5e7eb;
}

/* ===== STATUS BAR TOP CENTER ===== */
#statusBar{
  position:fixed;
  top:0;
  left:50%;
  transform:translateX(-50%);
  z-index:1000;
  background:rgba(34,197,94,0.15);
  border:1px solid rgba(34,197,94,0.5);
  padding:10px 20px;
  border-radius:0 0 10px 10px;
  font-size:0.9em;
  color:#bbf7d0;
  display:none;
  text-align:center;
  min-width:200px;
}

/* ===== CARD ===== */
.card{
  width:90%;
  max-width:480px;
  background:rgba(15,23,42,.75);
  backdrop-filter:blur(16px);
  border:1px solid rgba(56,189,248,.35);
  border-radius:20px;
  padding:20px;
  box-shadow:0 30px 60px rgba(0,0,0,.6);
  position:relative;
}

/* ===== HEADINGS ===== */
h2{margin:0 0 16px;color:#7dd3fc}

/* ===== LICENSE KEY INPUT ===== */
#keyInput {
  width:100%;
  padding:14px;
  border-radius:12px;
  border:1px solid rgba(56,189,248,.35);
  background:rgba(2,6,23,.9);
  color:white;
  font-size:1em;
  box-sizing:border-box;
  margin-bottom:12px;
  text-align:center;
}

/* ===== BUTTONS ===== */
button{
  border:none;
  border-radius:12px;
  cursor:pointer;
  font-weight:700;
}
button:hover{box-shadow:0 0 20px rgba(56,189,248,.5);}

/* ===== ROW / PILLS ===== */
.row{display:flex;gap:12px;margin-top:14px}
.pill{
  flex:1;
  padding:14px;
  border-radius:14px;
  background:rgba(2,6,23,.8);
  border:1px solid rgba(56,189,248,.35);
  text-align:center;
}
.admin-btn{
  background:rgba(56,189,248,.15);
  color:#7dd3fc;
  cursor:pointer;
}

/* ===== COPY BOX ===== */
.copy-box{
  display:flex;
  align-items:center;
  gap:8px;
  margin-top:18px;
  padding:10px 12px;
  border-radius:14px;
  background:rgba(2,6,23,.85);
  border:1px solid rgba(56,189,248,.35);
}

.copy-box span{
  flex:1;
  font-size:.85em;
  color:#7dd3fc;
  white-space:nowrap;       
  overflow-x:auto;          
  text-overflow:ellipsis;
  padding-right:6px;
}

/* Small square copy button */
.copy-btn{
  flex:0 0 auto;
  width:32px;
  height:32px;
  border:none;
  border-radius:8px;
  background:linear-gradient(135deg,#38bdf8,#60a5fa);
  color:#020617;
  font-weight:700;
  display:flex;
  align-items:center;
  justify-content:center;
  font-size:1em;
}
.copy-btn:hover{
  box-shadow:0 0 8px rgba(56,189,248,.5);
}

/* ===== LOGOUT BUTTON ===== */
.logout{
  width:100%;
  padding:14px;
  margin-top:14px;
  background:#ef4444;
  color:white;
}

/* ===== ADMIN DASHBOARD ===== */
#adminPanel{
  display:none;
  margin-top:14px;
  display:flex;
  flex-wrap:wrap;
  gap:10px;
}
#adminPanel button{
  flex:1 1 calc(33% - 10px);
  background:linear-gradient(135deg,#1f2937,#374151); /* dark grey glass */
  color:white;
  padding:10px;
  font-size:0.85em;
  border-radius:12px;
}
#adminPanel button:hover{
  box-shadow:0 0 10px rgba(255,255,255,.2);
}
</style>
</head>
<body>

<!-- STATUS BAR -->
<div id="statusBar">Copied to clipboard üìã</div>

<!-- LOGIN -->
<div class="card" id="login">
  <h2>Enter License Key</h2>
  <input id="keyInput" placeholder="EXEL-XXXX-XXXX">
  <button onclick="redeem()">Redeem</button>
</div>

<!-- APP -->
<div class="card" id="app" style="display:none">
  <h2>exel hub finder paid, find brainrots INSTANTLY ‚ö°‚è©</h2>

  <div class="row">
    <div class="pill">
      ‚è≥ Time remaining: <b id="timeLeft">--:--:--</b>
    </div>
    <div id="adminBtn" class="pill admin-btn" onclick="toggleAdmin()" style="display:none">
      Admin Dashboard
    </div>
  </div>

  <div id="adminPanel"></div>

  <!-- COPY BOX -->
  <div class="copy-box">
    <span id="scriptLabel">
loadstring(game:HttpGet("https://raw.githubusercontent.com/exelscripts/joiner/refs/heads/main/exel"))()
    </span>
    <button class="copy-btn" onclick="copyScript()">üìã</button>
  </div>

  <button class="logout" onclick="logout()">Logout</button>
</div>

<script>
/* CONFIG */
const SUPABASE_URL = "https://skdhrvgrpcuvvfedkinc.supabase.co";
const SUPABASE_KEY = "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6InNrZGhydmdycGN1dnZmZWRraW5jIiwicm9sZSI6ImFub24iLCJpYXQiOjE3Njk5Mzk2MzMsImV4cCI6MjA4NTUxNTYzM30.YAZhwmjIrnqJfl-zVT6_a7zGDITbr6twMYCBoo_bbhs";
const ADMIN_KEY = "EXEL-ADMIN-2704";

/* LOGIN */
async function redeem(){
  const key = keyInput.value.trim().toUpperCase();
  if(!key) return;
  if(key === ADMIN_KEY){
    localStorage.setItem("admin","1");
    showApp(true);
    return;
  }
  const res = await fetch(`${SUPABASE_URL}/rest/v1/licenses?key=eq.${key}&is_banned=eq.false`,{
    headers:{apikey:SUPABASE_KEY,Authorization:`Bearer ${SUPABASE_KEY}`}
  });
  const data = await res.json();
  if(!data.length){ alert("Invalid key"); return; }
  const lic = data[0];
  if(Date.now() >= lic.expires_at){ alert("Key expired"); return; }
  localStorage.setItem("key", key);
  localStorage.setItem("expires", lic.expires_at);
  showApp(false);
}

/* APP */
function showApp(admin){
  login.style.display="none";
  app.style.display="block";
  adminBtn.style.display = admin ? "flex":"none";
  if(admin){
    timeLeft.textContent="inf ‚ôæÔ∏è";
    renderAdmin();
  } else { startTimer(); }
}

function startTimer(){
  const exp = parseInt(localStorage.getItem("expires"));
  function tick(){
    const left = Math.floor((exp - Date.now())/1000);
    if(left <= 0){ alert("Expired"); logout(); return; }
    const h=Math.floor(left/3600);
    const m=Math.floor((left%3600)/60);
    const s=left%60;
    timeLeft.textContent =
      `${h.toString().padStart(2,"0")}:`+
      `${m.toString().padStart(2,"0")}:`+
      `${s.toString().padStart(2,"0")}`;
    requestAnimationFrame(tick);
  }
  tick();
}

/* ADMIN DASHBOARD */
function toggleAdmin(){
  adminPanel.style.display =
    adminPanel.style.display==="flex"?"none":"flex";
}

function renderAdmin(){
  adminPanel.innerHTML="";
  const times=[["1 Hour",3600],["1 Day",86400],["1 Week",604800]];
  times.forEach(t=>{
    const b=document.createElement("button");
    b.textContent="Generate "+t[0];
    b.onclick=()=>generate(t[1]);
    adminPanel.appendChild(b);
  });
}

/* COPY SCRIPT WITH STATUS BAR */
function copyScript(){
  const text = document.getElementById("scriptLabel").innerText;
  navigator.clipboard.writeText(text);
  const statusBar = document.getElementById("statusBar");
  statusBar.style.display="block";
  setTimeout(()=>statusBar.style.display="none",1200);
}

/* LOGOUT */
function logout(){
  localStorage.clear();
  location.reload();
}

/* AUTO LOGIN */
if(localStorage.getItem("admin")) showApp(true);
else if(localStorage.getItem("key")) showApp(false);

/* GENERATE KEY */
async function generate(seconds){
  const key="EXEL-"+Math.random().toString(36).slice(2,6).toUpperCase()+"-"+Math.random().toString(36).slice(2,6).toUpperCase();
  const expires=Date.now()+seconds*1000;
  const res = await fetch(`${SUPABASE_URL}/rest/v1/licenses`,{
    method:"POST",
    headers:{
      "Content-Type":"application/json",
      apikey:SUPABASE_KEY,
      Authorization:`Bearer ${SUPABASE_KEY}`,
      Prefer:"return=minimal"
    },
    body:JSON.stringify({ key:key, expires_at:expires })
  });
  if(!res.ok){ alert("Failed"); return; }
  await navigator.clipboard.writeText(key);
  const statusBar = document.getElementById("statusBar");
  statusBar.textContent = "Copied to clipboard üìã ‚Üí "+key;
  statusBar.style.display="block";
  setTimeout(()=>statusBar.style.display="none",1600);
}
</script>
</body>
</html>
